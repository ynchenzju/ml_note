线性模型的问题：有可能因变量和自变量之间的关系不是直接的线性关系，但是可能可以通过一个连接函数对自变量进行变换后，变换后的变量和因变量之间是线性关系。  
特别的，当因变量Y和自变量X属于指数分布簇时，我们能够获得因变量的期望E(y)和线性预测子$\theta^tX$之间的连接函数f，从而建立一个连接函数f意义下的线性模型，这样的线性模型称为广义线性模型。

-----

Y和X满足指数分布簇:  
$$p(Y, \eta)=B(Y)*e^{(\eta * T(Y)-B(\eta))}$$  
其中$\eta=\theta^TX$,也就是线性预测子。  
连接函数$h(\cdot)=E(T(Y))$，而$T(Y)一般等于Y$，所以连接函数$h(\cdot)=E(T(y))=E(y)$  
这里有几个问题记录如下:  
1. 连接函数$h(\cdot)=E(T(Y))$:这个在数学上可以证明(但看的资料中没有介绍，暂时默认正确)。  
2. $T(Y)$称为充分统计量(sufficient statistic)，通常$T(y)=y$: 这个点暂时没有深究，先默认正确。 前面那句话"我们能够获得因变量的期望E(y)"中的E(y)准确来说应该改为E(T(y))
3. 对于Y，X不满足指数分布的，等式$h(\cdot)=E(T(Y))$不成立，其也不属于广义线性模型，但不是不可以计算。  
-------

常见的逻辑斯蒂回归就是广义线性模型的一个特例。逻辑斯蒂回归是为了解决二分类问题。而一个二分类问题的分布是伯努利分布，$P(y)=\theta(x)^y(1-\theta(x))^{1-y}, y=0或1$， 这里$\theta(x)$就是y=1发生的概率分布（注意不是概率）。  
这里一个理解记录如下：通常资料上伯努利分布都是写作$P(y)=\theta^y(1-\theta)^{1-y}, y=0或1$, 这里$\theta$看起来是一个常量。其实这是在选定X的情况下。比如考虑以下场景:一个袋子装有红黑两色的球，数目分别是10和10，从这个袋子里取一个球，求是红色球的概率。那这里X就被确定了，$\theta(X=(红:10, 黑:10))=0.5$，此处概率分布函数$\theta(x)$就变成了一个概率数值$\theta$。  

一个分布是指数分布族，则有以下结论：  
1. 指数型分布随机变量的期望$E(Y)=\frac{dB(\eta)}{d\eta}$  
2. 指数型分布随机变量的方差$Var(Y)=\frac{d^2B(\eta)}{d\eta^2}$  
因此判断一个分布是不是指数分布簇，可以根据上面两条结论去判定。  
二项分布属于指数分布族的证明：对于二项分布（伯努利分布），可以表示为：  
$p(y=1;\phi(x))=\phi(x);p(y=0;\phi(x))=1-\phi(x)$  
把二项分布改写为指数分布的形式(这里方便起见把$\phi(x)$写为$\phi$)：  
$$p(y;\phi(x))=\phi^y(1-\phi)^{1-y}\\\qquad\qquad\qquad\quad=exp(yln\phi+(1-y)ln(1-\phi))$$  
$$\qquad\qquad\qquad\quad=exp(ln(\frac{\phi}{1-\phi})y+ln(1-\phi))$$  
按照指数分布的形式，可以得到，  
$$\eta=ln(\frac{\phi}{1-\phi}), 进而有\phi=\frac{1}{1+e^{-\eta}}$$  
$$T(y)=y$$  
$$B(Y)=1$$  
$$B(\eta)=-ln(1-\phi)=ln(1+e^{\eta})$$  
此时我们只是按照指数分布簇的形式，改写了式子并得到一些关系，但还没证明该分布就是指数分布族。那么接下来就是要求$\frac{dB(\eta)}{d\eta},\frac{d^2B(\eta)}{d\eta^2}$  
$$\frac{dB(\eta)}{d\eta}=\frac{e^\eta}{1+e^\eta}=\phi$$  
$$\frac{d^2B(\eta)}{d\eta^2}=\frac{e^\eta}{(1+e^\eta)^2}=\phi(1-\phi)$$  
这正好分别等于二项分布的E(Y)和Var(Y)，因此二项分布是指数分布簇。  
因为是指数分布簇，所以有(这是在证明了二项分布属于是指数函数族后才有的结论) 
$$\eta=\theta^Tx$$  
而同时$\phi=\frac{1}{1+e^\eta}$，所以有(注意这里$\phi$是x的函数，方便起见才没写$\phi(x)$)  
$$\phi=\frac{1}{1+e^{-\theta^Tx}}$$  
因此二项分布的概率分布函数可以表示为  
$$p(y;\phi(x))=(\frac{1}{1+e^{-\theta^Tx}})^y(\frac{e^{-\theta^Tx}}{1+e^{-\theta^Tx}})^{1-y},y =1或0$$  
所以如果一个分布有可能是指数分布族，想要求该分布的概率分布函数，基本步骤为：  
* 改写成指数分布族的形式，获得一些等式关系。
* 计算$\frac{dB(\eta)}{d\eta},\frac{d^2B(\eta)}{d\eta^2}$，观察是否等于原来分布的E(y),Var(y)。是的话就证明了该分布是指数分布族。
* 如果该分布是指数分布族，那么$\eta=\theta^Tx$, 进而求得$\theta^Tx$和原来分布$\phi(x)$的关系。